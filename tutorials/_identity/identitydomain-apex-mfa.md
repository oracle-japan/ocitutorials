---
title: "OCI IAM Identity DomainでAPEXで作成したアプリケーションにMFAを設定する"
excerpt: "OCI IAM Identity DomainでAPEXで作成したアプリケーションにMFAを設定する手順を紹介します。"
order: "160"
layout: single
tags:
 - intermediate
header:
 teaser: "/identity/identitydomain-apex-sso/apex-10.png"
 overlay_image: "/identity/identitydomain-apex-sso/apex-10.png"
 overlay_filter: rgba(34, 66,55, 0.7)

---

本チュートリアルでは、Oracle Application Express（APEX）で作成したアプリケーションにアクセスする際にMFAを要求する手順を紹介します。

本チュートリアルを完了すると、Identity DomainのユーザーAPEXアプリケーションにアクセスした際にMFAによる認証を要求することできます。


**所要時間 :** 約10分

**前提条件 :**
+ OCIチュートリアル[OCI IAM Identity DomainでAPEXで作成したアプリケーションに認証と認可をする](/identity/identitydomain-apex-sso)を参考に、APEXアプリケーションとIdentity Domainsの認証連携ができていること。


**注意 :**
※チュートリアル内の画面ショットについてはOracle Cloud Infrastructureの現在のコンソール画面と異なっている場合があります。

<br>

# 1. MFAの設定

MFAの要素として電子メールのワンタイム・パスワードやモバイルアプリケーションによる認証どを設定することができますが、本手順では電子メールのワンタイム・パスワードを要求するように設定します。

ドメイン・メニューの「認証」を選択します。ファクタ部分の電子メールが無効になっている場合には「ファクタの有効化または無効化」を選択します。

 ![画面ショット1](image01.png)


ファクタの有効化または無効化画面にて「電子メール」をチェックONにし、「変更の保存」を選択します。他のMFAを有効化したい場合は、そのMFAをチェックをONにします。

 ![画面ショット1](image02.png)

次に、APEXサンプルアプリアクセス時にMFAを必須にするサインオンポリシーを定義するため、ドメインメニュー「ドメイン・ポリシー」を選択します。サインオン・ポリシー部分にて「サインオン・ポリシーの作成」を選択します。

 ![画面ショット1](image03.png)

ポリシーの作成画面にて、任意の名前を入力し、「サインオン・ポリシーの作成」を選択します。

 ![画面ショット1](image04.png)

作成されたサインオン・ポリシーの画面にてメニュー「サインオン・ルール」を選択し、「サインオン・ルールの追加」を選択します。

 ![画面ショット1](image05.png)

 ![画面ショット1](image06.png)

サインオン・ルールの追加画面にて、ルール名に任意の名前を入力し、アクション部分にて下記を設定し、「追加」を選択します。
 - 追加ファクタの要求にチェック
 - 指定されたファクタのみにチェック
 - 電子メールににチェック
 - 頻度‐セッションごと・・・・・にチェック
 - 登録‐必須にチェック

 ![画面ショット1](image07.png)
 ![画面ショット1](image08.png)
 ![画面ショット1](image09.png)

サインオン・ルールが作成されたことを確認し、メニュー「アプリケーション」を選択し、「アプリケーションの追加」を選択します。
 ![画面ショット1](image10.png)

アプリケーションの追加画面にて上記にて作成したAPEX用機密アプリケーションにチェックし「アプリケーションの追加」を選択します。

 ![画面ショット1](image11.png)

右上のアクションより「サインオン・ポリシーのアクティブ化」を選択します。

 ![画面ショット1](image12.png)

確認画面でも「サインオン・ポリシーのアクティブ化」を選択します。
 ![画面ショット1](image13.png)


# 動作確認
アプリケーションにアクセスしMFAの動作確認をします。

アイデンティティ・ドメインのログイン画面が表示されたことを確認し、上記で作成したテストユーザーのID/パスワードを指定し「サインイン」を選択します。
 ![画面ショット1](image14.png)

セキュアな検証の有効化画面にて「セキュアな検証の有効化」を選択します。
 ![画面ショット1](image15.png)

MFA要素の選択画面にて「電子メール」を選択します。
 ![画面ショット1](image16.png)

テストユーザーのメールアドレスに記載されているパスコードを確認します。
 ![画面ショット1](image17.png)
確認したパスコードをブラウザ画面のコード部分に入力し、「電子メール・アドレスの確認」を選択します。
 ![画面ショット1](image18.png)

MFA要素「電子メール」の登録が完了したことを確認し「完了」を選択すると、APEXアプリケーションにアクセスできます。
 ![画面ショット1](image19.png)

 ![画面ショット1](image21.png)

次回以降からアプリケーションへのアクセスは、ログイン画面⇒MFA(電子メールワンタイムパスコード指定)⇒アプリケーションへという流れになることを確認します。
 ![画面ショット1](image14.png)
 ![画面ショット1](image20.png)
 ![画面ショット1](image21.png)

