---
title: "OCI HPCポータル"
excerpt: "OCI上にHPCシステムを構築するためのチュートリアル集をコンテンツの中核とする、OCI HPCポータルです。OCIが提供するベアメタルインスタンス、GPUインスタンス、クラスタ・ネットワーク等を活用し、様々な用途のHPCクラスタやGPUクラスタを、リソース・マネージャ、Terraform、Ansibleを駆使して効率的にOCI上に構築する方法を学習するチュートリアル集や、ベンチマーク情報、テクニカルTips、関連情報リンク集等、HPCワークロードをOCI上で実行する際に有益な情報を、技術面にフォーカスしてお届けします。チュートリアルで構築するHPCクラスタは、NFS、LDAP、Slurm、OpenMPI等、システム運用・利用に欠かせないソフトウェアが使えます。またGPUクラスタは、NVIDIA Container Toolkit、DockerやEnrootのコンテナランタイム等、大規模な分散機械学習ワークロード実行に必須のソフトウェアが使えます。"
permalink: /hpc/
layout: splash
tags: "hpc"
toc: true
date: "2023-03-08"
lastmod: "2023-03-08"
---

このページは、HPCワークロードをOracle Cloud Infrastructure（以降OCIと記載）上で実行する際に有益な情報を技術面にフォーカスしてお届けするポータルサイト **OCI HPCポータル** です。

現時点で提供する主要なコンテンツは、HPCシステム構築に最適なベアメタルインスタンス、GPUインスタンス、クラスタ・ネットワーク等の各種IaaSサービスを組み合わせて様々な用途のHPCクラスタやGPUクラスタを構築する **[OCI HPCチュートリアル集](#1-oci-hpcチュートリアル集)** で、自身の要件に合わせて利用するチュートリアルを選択できるようになっています。  
その構築手法は、 **[リソース・マネージャ](#2-2-リソースマネージャ)** 、Terraform、Ansibleを駆使する **[マーケットプレース](#2-5-マーケットプレイス)** 提供の **[スタック](#2-3-スタック)** を利用した自動構築と、OCIのコンソールから各ステップを自身で確認・実行しながら実施する手動構築から選択出来、また構築するHPCシステムは、クラスタ管理機能の有無や利用できるソフトウェアから選択することが可能です。

また、本ポータルサイトを読み進めるうえで理解が必要なHPC関連のOCI用語を解説する、 **[OCI HPC用語集](#2-oci-hpc用語集)** も用意されています。

今後は、OCI上に構築したHPCシステムのベンチマーク情報、テクニカルTips、関連情報リンク集等、HPCワークロードをOCI上で実行する際に有益な情報をお届けする予定です。

***
# 1. OCI HPCチュートリアル集

## 1-0. 概要

本章は、様々な用途のHPCシステムをOCI上に構築するチュートリアルを集めた、OCI HPCチュートリアル集です。

各チュートリアルは、以下3つのカテゴリに分類されます。

- **[HPCクラスタ](#1-1-hpcクラスタ)**

   このカテゴリは、最新のCPUを搭載するベアメタルインスタンスを **[クラスタ・ネットワーク](#2-1-クラスタネットワーク)** で高速・低遅延に接続する、CPUワークロード向けHPCクラスタを構築するためのチュートリアルを集めています。  
   チュートリアルで構築するHPCクラスタは、NFS、LDAP、Slurm、OpenMPI等、システム運用・利用に欠かせないソフトウェアが使えます。

- **[機械学習環境](#1-2-機械学習環境)**

   このカテゴリは、GPUを搭載する単一のVMインスタンスを使用する小規模機械学習環境から、最新のGPUを複数搭載するベアメタルインスタンスを複数のポートで **[クラスタ・ネットワーク](#2-1-クラスタネットワーク)** に高速・低遅延で接続する複数ノードに跨る大規模機械学習ワークロード向けGPUクラスタまで、機械学習環境を構築するためのチュートリアルを集めています。  
   チュートリアルで構築するGPUクラスタは、NVIDIA Container Toolkit、DockerやEnrootのコンテナランタイム等、大規模な分散機械学習ワークロード実行に必須のソフトウェアが使えます。

- **[ファイル共有ストレージ](#1-3-ファイル共有ストレージ)**

   このカテゴリは、HPCクラスタやGPUクラスタを運用する際に必須となるファイル共有ストレージを、OCIのサービスを組み合わせて構築するためのチュートリアルを集めています。

これらのチュートリアルで構築されたHPCシステムは、そのままでも十分実用に耐えますが、異なるカテゴリのチュートリアルを組み合わせることで、より実践的なHPCシステムを構築することが可能です。  
このような手法は、 **[チュートリアルを組み合わせた実践的HPCシステム構築](#1-4-チュートリアルを組み合わせた実践的hpcシステム構築)** で紹介しています。

各カテゴリは、利用目的や構築手法の異なるチュートリアルを複数用意しており、自身の要件に合わせて以下の観点で使用するチュートリアルを選択します。

- 構築手法

   構築手法は、 **[スタック](#2-3-スタック)** を使用する自動構築と、OCIコンソールから各リソースを順次構築する手動構築に分かれ、それぞれ以下の利点・欠点があります。

|      | 利点                             | 欠点                                                        |
| ---- | ------------------------------ | --------------------------------------------------------- |
| 自動構築 | ユーザの作業時間が短い                    | 構築手順のブラックボックス化<br>　・システム構成の変更が難しい<br>　・問題発生時の原因究明が難しい |
| 手動構築 | 構築手順が明確<br>　・システム構成の変更が容易<br>　・問題発生時の原因究明が容易 | ユーザの作業時間が長い                                               |

- クラスタ管理機能の有無

   構築するHPCクラスタやGPUクラスタは、以下のクラスタ管理機能を利用可能とするか、これらを含まない基礎インフラストラクチャのみを構築するかを選択する事が可能です。

   - LDAPによるユーザ統合管理
   - NFSによるユーザホームディレクトリ共有
   - Slurmによるジョブスケジュール・計算リソース管理

- スタティック/オンデマンドクラスタ

   構築するHPCクラスタやGPUクラスタは、ワークロードを実行する際に動的に必要な計算リソースをデプロイするオンデマンドクラスタとして構築するか、ワークロードの有無にかかわらず常に計算リソースを起動しておくスタティッククラスタとして構築するかを選択することが可能です。

- コンテナランタイム

   機械学習環境カテゴリに含まれるチュートリアルは、構築する環境のコンテナランタイムを以下から選択することが可能です。
   
   - Docker Community Edition
   - Enroot with Pyxis integrated in Slurm

## 1-1. HPCクラスタ

本章は、HPCクラスタを構築するチュートリアルを集めています。自身の要件に合わせてチュートリアルを選んだら、そのチュートリアル名をクリックします。

| チュートリアル名                                                                                         | 構築手法 | クラスタ<br>管理機能 | スタティック/<br>オンデマンド |
| ------------------------------------------------------------------------------------------------ | ---- | -------- | ----------------- |
| **[HPCクラスタを構築する<br>(基礎インフラ手動構築編)](/ocitutorials/hpc/spinup-cluster-network/)** | 手動   | 無し       | スタティック            |
| **[HPCクラスタを構築する<br>(スタティッククラスタ自動構築編)](/ocitutorials/hpc/spinup-hpc-cluster)** | 自動   | 有り       | スタティック            |
| HPCクラスタを構築する<br>(オンデマンドクラスタ自動構築編)<br>(近日公開予定)                                                    | 自動   | 有り       | オンデマンド            |

## 1-2. 機械学習環境

本章は、機械学習環境を構築するチュートリアルを集めています。自身の要件に合わせてチュートリアルを選んだら、そのチュートリアル名をクリックします。

| チュートリアル名                                                                                                   | GPU<br>インスタンス | 構築手法 | クラスタ<br>管理機能 | スタティック/<br>オンデマンド | コンテナランタイム |
| ---------------------------------------------------------------------------------------------------------- | ------------- | ---- | -------- | ----------------- | --------- |
| **[GPUインスタンスで機械学習にトライ](/ocitutorials/hpc/spinup-ml-instance/)**                          | 単一            | 手動   | 無し       | スタティック            | Docker CE |
| **[GPUクラスタを構築する<br>(基礎インフラ手動構築編)](/ocitutorials/hpc/spinup-gpu-cluster/)**               | 複数            | 手動   | 無し       | スタティック            | Docker CE |
| **[GPUクラスタを構築する<br>(スタティッククラスタ自動構築編)](/ocitutorials/hpc/spinup-gpu-cluster-withstack/)** | 複数            | 自動   | 有り       | スタティック            | Enroot    |
| GPUクラスタを構築する<br>(オンデマンドクラスタ自動構築編)<br>(近日公開予定)                                                              | 複数            | 自動   | 有り       | オンデマンド            | Enroot    |

## 1-3. ファイル共有ストレージ

本章は、HPCクラスタやGPUクラスタから利用するファイル共有ストレージを、ブロックストレージを使用してマーケットプレイスのスタックから自動構築するチュートリアル **ブロックストレージでNFSファイルサーバを構築する** を近日中に公開する予定です。

## 1-4. チュートリアルを組み合わせた実践的HPCシステム構築

本章は、異なるカテゴリのチュートリアルを組み合わせてより実践的なHPCシステムを構築する手法を紹介します。

近日公開予定のチュートリアルは、 **ブロックストレージでNFSファイルサーバを構築する** で構築したファイル共有ストレージを **[HPCクラスタ](#1-1-hpcクラスタ)** のカテゴリや **[機械学習環境](#1-2-機械学習環境)** のカテゴリのチュートリアルで構築するHPCクラスタやGPUクラスタの共有ストレージ領域として構築する、というものです。公開まで、暫くお待ちください。

***
# 2. OCI HPC用語集

本章は、OCIのHPCに関連する用語を解説する用語集です。

本ポータルサイトを読み進める際、不明なOCI用語の理解に役立ててください。

## 2-1. クラスタ・ネットワーク

クラスタ・ネットワークは、ノード間を高帯域・低レイテンシに接続するインターコネクトネットワークで、以下の特徴を持ちます。

- RoCEv2を採用するRDMAインターコネクト
- 100 GbpsリンクあたりのMPI通信で最大12GB/sの帯域幅と最小1.5μsのレイテンシ
- オーバーサブスクリプションの無いフラットなトポロジーによる再現性の高いネットワーク特性

クラスタ・ネットワークは、OCIのリソースとして定義し、指定したノード数のインスタンスとともにデプロイされ、これらのインスタンスをクラスタ・ネットワークに接続します。  
クラスタ・ネットワークの作成は、 **[インスタンス構成](#2-7-インスタンス構成)** とインスタンス数を指定して行い、このインスタンス構成に紐づく **[インスタンス・プール](#2-8-インスタンスプール)** が自動的に作成され、このインスタンス・プールがクラスタ・ネットワークに接続するインスタンスをデプロイします。  
なお、インスタンスがクラスタ・ネットワークに接続するためのIPアドレス設定を含む、OSレベルで定義されるネットワークインターフェースは、ユーザ自身で設定する必要があります。本ポータルサイトのチュートリアルは、cloud-initやAnsibleでこれらの設定を自動化しています。

関連するOCI公式ドキュメントは、 **[ここ](https://docs.oracle.com/ja-jp/iaas/Content/Compute/Tasks/managingclusternetworks.htm)** を参照ください。

OCIコンソールのクラスタ・ネットワークメニューは、 **[ここ](https://cloud.oracle.com/compute/cluster-networks)** をクリックしてアクセスします。OCIへのログインを要求された場合は、ログインを完了して下さい。

## 2-2. リソース・マネージャ

リソース・マネージャは、OCIのリソース管理（作成・変更・削除）の自動化をInfrastructure-as-code （IaC）のコンセプトで実現する、OCIコンソールからGUIで操作するマネージドTerraformサービスで、OCIの様々なサービスを組み合わせた複雑なシステムの構築を自動化することで、システム構築や運用に必要な工数を大幅に削減します。

リソース・マネージャは、様々なOCIサービスを組み合わせたシステム構築作業を、メニュー形式で予めオプションを選択して作成された **[スタック](#2-3-スタック)** をOCIコンソールから適用・破棄することで、1クリックで実施することを可能にします。

関連するOCI公式ドキュメントは、 **[ここ](https://docs.oracle.com/ja-jp/iaas/Content/ResourceManager/Concepts/resourcemanager.htm)** を参照ください。

リソース・マネージャの利用方法は、チュートリアル **[リソース・マネージャを使ってサンプルアプリケーションをデプロイする](https://oracle-japan.github.io/ocitutorials/intermediates/resource-manager/)** を参照ください。

OCIコンソールのリソース・マネージャメニューは、 **[ここ](https://cloud.oracle.com/resourcemanager/overview)** をクリックしてアクセスします。OCIへのログインを要求された場合は、ログインを完了して下さい。

## 2-3. スタック

スタックは、 **[リソース・マネージャ](#2-2-リソースマネージャ)** から作成するOCIリソースで、デプロイするOCIリソースの構成情報をコードとして記述したTerraform構成ファイル群と **[スキーマ・ドキュメント](#2-4-スキーマドキュメント)** を元に作成され、リソース・マネージャが管理するOCIリソースの定義情報を持ちます。

作成されたスタックは、リソースマネージャから適用・破棄することで、定義したリソースをOCIコンソールから1クリックでデプロイ・削除することを可能にします。

関連するOCI公式ドキュメントは、 **[ここ](https://docs.oracle.com/ja-jp/iaas/Content/ResourceManager/Concepts/resourcemanager.htm#concepts)** の **スタック** を参照ください。

スタックの作成方法は、チュートリアル **[リソース・マネージャを使ってサンプルアプリケーションをデプロイする](https://oracle-japan.github.io/ocitutorials/intermediates/resource-manager/)** を参照ください。

OCIコンソールのスタックメニューは、 **[ここ](https://cloud.oracle.com/resourcemanager/stacks)** をクリックしてアクセスします。OCIへのログインを要求された場合は、ログインを完了して下さい。

## 2-4. スキーマ・ドキュメント

スキーマ・ドキュメントは、 **[リソース・マネージャ](#2-2-リソースマネージャ)** から **[スタック](#2-3-スタック)** を作成する際、デプロイするシステム構成情報を選択するメニューを定義する、YAML形式のファイルです。例えば、デプロイするインスタンスのシェイプを選択するメニュー、インスタンスにアタッチするブートボリュームのサイズを指定するメニュー、インスタンスにログインするSSH公開鍵を指定するメニューを、適切なスキーマ・ドキュメントを作成することで実現出来ます。

関連するOCI公式ドキュメントは、 **[ここ](https://docs.oracle.com/ja-jp/iaas/Content/ResourceManager/Concepts/terraformconfigresourcemanager_topic-schema.htm#top)** を参照ください。

## 2-5. マーケットプレイス

マーケットプレイスは、 **[スタック](#2-3-スタック)** と **[カスタム・イメージ](#2-6-カスタムイメージ)** を提供する、オラクルが運営するオンライン・ストアです。

マーケットプレイスから提供されるスタックやカスタムイメージは、オラクルはもちろんそのパートナーが提供するものも含まれ、その多くが無料で提供されます。これらマーケットプレイスから提供されるリソースを活用することで、OCI上にHPCシステムを構築する作業工数を大幅に削減することが可能で、**[OCI HPCチュートリアル集](#1-oci-hpcチュートリアル集)** でもこれらを活用する方法が紹介されています。

関連するOCI公式ドキュメントは、 **[ここ](https://docs.oracle.com/ja-jp/iaas/Content/Marketplace/Concepts/marketoverview.htm)** を参照ください。

OCIコンソールのマーケットプレイスメニューは、 **[ここ](https://cloud.oracle.com/marketplace/home)** をクリックしてアクセスします。OCIへのログインを要求された場合は、ログインを完了して下さい。

## 2-6. カスタム・イメージ

カスタムイメージは、実行中のインスタンスから取得するOSのブートイメージで、カスタマイズを適用したインスタンスと同じ状態のインスタンスの複製を可能にします。

HPCクラスタやGPUクラスタ構築の際、OSレベルのカスタマイズを加えたインスタンスから取得したカスタム・イメージを活用し、デプロイ後のカスタマイズ処理を省略することで、構築時間を短縮することが可能です。

**[マーケットプレース](#2-5-マーケットプレイス)** から提供されるHPC向けのイメージは、 **[クラスタ・ネットワーク](#2-1-クラスタネットワーク)** に接続するためのソフトウェア等を含む、カスタム・イメージとして提供されます。

関連するOCI公式ドキュメントは、 **[ここ](https://docs.oracle.com/ja-jp/iaas/Content/Compute/Tasks/managingcustomimages.htm)** を参照ください。

OCIコンソールのカスタム・イメージメニューは、 **[ここ](https://cloud.oracle.com/compute/images)** をクリックしてアクセスします。OCIへのログインを要求された場合は、ログインを完了して下さい。

## 2-7. インスタンス構成

インスタンス構成は、デプロイするインスタンスの構成情報（コンパートメント、AD、シェイプ、イメージ、ブートボリュームサイズ、SSH公開鍵、cloud-init構成ファイル等）を持ちます。

インスタンス構成は、同じ構成のインスタンスを複製することを可能とし、HPCシステムの構築・管理に必須の機能です。

関連するOCI公式ドキュメントは、 **[ここ](https://docs.oracle.com/ja-jp/iaas/Content/Compute/Concepts/instancemanagement.htm#config)** を参照ください。

OCIコンソールのインスタンス構成メニューは、 **[ここ](https://cloud.oracle.com/compute/instance-configs)** をクリックしてアクセスします。OCIへのログインを要求された場合は、ログインを完了して下さい。

## 2-8. インスタンス・プール

インスタンス・プールは、同じイメージのインスタンス群を一括デプロイ・スケールアウト・スケールイン・一括削除する機能を持ち、HPCシステムの構築・管理に必須の機能です。

インスタンス・プールは、 **[インスタンス構成](#2-7-インスタンス構成)** を指定して作成し、新たなインスタンスをこのインスタンス構成に基づいてデプロイします。

関連するOCI公式ドキュメントは、 **[ここ](https://docs.oracle.com/ja-jp/iaas/Content/Compute/Concepts/instancemanagement.htm#Instance)** を参照ください。

OCIコンソールのインスタンス・プールメニューは、 **[ここ](https://cloud.oracle.com/compute/instance-pools)** をクリックしてアクセスします。OCIへのログインを要求された場合は、ログインを完了して下さい。
