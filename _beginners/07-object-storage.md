---
title: "チュートリアル - オブジェクト・ストレージを使う"
subtitle: "チュートリアル : Oracle Cloud Ingrastructureを使ってみよう - その8"
excerpt: "オブジェクト・ストレージを使うと、とても堅牢なデータストアを信じられないくらい安価に利用できます。まずは簡単な使い方を学びましょう"
categories:
  - Services
  - Compute
tags:
  - スライドあり
  - レベル:応用(200)
---

Oracle Cloud Infrastructureオブジェクト・ストレージ・サービスは、高い信頼性と高い費用対効果を両立するスケーラブルなクラウドストレージです。
オブジェクト・ストレージを利用すると、分析用のビッグ・データや、イメージやビデオ等のリッチ・メディア・コンテンツなど、あらゆるコンテンツ・タイプの非構造化データを無制限に保管できます。

オブジェクト・ストレージはリージョン単位のサービスで、コンピュート・インスタンスからは独立して動作します。
ユーザーはオブジェクト・ストレージのエンドポイントに対し、OCIの内部、外部を問わずどこからでもアクセスすることができます。
OCIのIdentity and Access Management(IAM)機能をを利用した適切なアクセスコントロールや、リソース・リミットを設定することも可能です。

この章では、コンソール画面からオブジェクト・ストレージにアクセスし、スタンダード・バケットの作成やオブジェクトのアップロード、ダウンロードなどの基本的な操作、また事前認証リクエストを作成して一般ユーザー向けにダウンロードリンクを生成する手順について学習します。

- **所要時間** : 15分

- **前提条件** : 適切なコンパートメント(ルート・コンパートメントでもOKです)と、そこに対する適切なオブジェクト・ストレージの管理権限がユーザーに付与されていること

- **注意** : チュートリアル内の画面ショットについてはOracle Cloud Infrastructureの現在のコンソール画面と異なっている場合があります


# 1. コンソール画面の確認とバケットの作成

オブジェクト・ストレージ・サービスにおいて、バケットはオブジェクトを格納する箱として機能します。
バケットはコンパートメントに紐付ける必要があり、バケットおよびその中のオブジェクトに対する操作に関する権限は、コンパートメントのポリシーを通じて制御します。

まず、コンソール画面からバケットを作成していきます。

1. コンソールメニューから **ストレージ → オブジェクト・ストレージ** を選択し、**バケットの作成** ボタンを押します

2. 立ち上がった **バケットの作成** ウィンドウに以下の項目を入力し、**バケットの作成** ボタンを押します。指定がないものは任意の値でOKです。
    - **バケット名** - 任意の文字列 (画面では TutorialBucket と入力しています)
    - **ストレージ層** - *標準* を選択
    - **オブジェクト・バージョニングの有効化** - チェックなし
    - **暗号化** - *ORACLE管理キーを使用した暗号化* を選択  
    ![画面ショット](001.webp)

3. バケットの作成が完了し、コンソールに表示されていることを確認します
    ![画面ショット](002.webp)


# 2. オブジェクトのアップロード、ダウンロード

1. 作成したバケット名のリンクをクリックし、バケットの詳細画面を表示します

1. **アップロード** ボタンを押します

1. 立ち上がった **オブジェクトのアップロード** ウィンドウで **ファイルを選択** リンクを押してローカルPCのファイルを選択するか、またはドラッグ&ドロップでファイルをウィンドウの ここにファイルをドロップします... という場所にドロップします

    ![画面ショット](003.webp)

1. 必要に応じて **オブジェクト名の接頭辞** を入力し、**アップロード** ボタンを押します。ファイル名に日本語が含まれる場合は、ここをASCII文字で設定することを推奨します。

    > **TIPS**  
    > オブジェクト名の接頭辞は、後からこのオブジェクトにアクセスする際のURIパスに含まれるため、わかりやすい名称をつけるようにしてください。
    > UNICODE文字であれば日本語でも可能ですが、アクセス時にクライアント側でURLエンコード処理を行う必要があります。
    > オブジェクト名の命名についての詳細は、マニュアルの [オブジェクトの管理 - オブジェクト名](https://docs.cloud.oracle.com/ja-jp/iaas/Content/Object/Tasks/managingobjects.htm#namerequirements) をご覧ください。

1. オブジェクトが正しくアップロードされたことを確認します

    ![画面ショット](004.webp)

1. アップロードしたオブジェクトの右側の ・・・ メニューから **オブジェクト詳細の表示** を選択し、オブジェクトの詳細情報を表示します

    ![画面ショット](005.webp)

1. **ダウンロード** ボタンを押して、オブジェクトが正しくダウンロードできることを確認します


# 3. 事前認証済リクエストの作成

事前認証リクエスト(Pre-Authenticated Request) は、Oracle Cloud Infrastructure の認証されたユーザー以外のメンバーに対して、オブジェクトへのアクセス権限を付与する際に利用します。

事前認証リクエストは、バケット単位またはオブジェクト単位で作成でき、個別に読取、書込、読み書きの権限を設定することができ、また有効期限を設定することができます。リクエストを生成すると一意のランダムなアクセスURLが生成されます。

今回は、先ほどアップロードしたオブジェクトに対する読み取り権限を付与する事前認証リクエストを作成します。

1. 先ほどアップロードしたオブジェクトの右側の ・・・ メニューから **事前認証済リクエストの作成** を選択します

1. 立ち上がった **事前認証済リクエストの作成** ウィンドウに以下の項目を入力し、 **事前認証済リクエストの作成** ボタンを押します
    - **名前** - 任意 (画面上では TutorialPreAuthReq と入力しています)
    - **事前認証済リクエスト・ターゲット** - *オブジェクト* を選択
    - **アクセス・タイプ** - *オブジェクトに対する読み取りを許可* を選択
    - **有効期限＊* - デフォルトのまま

    ![画面ショット](006.webp)

1. 事前認証リクエストの作成が完了すると、リクエストURLが生成されます。ウィンドウに表示された情報を確認し、**事前認証済リクエストのURL** ボックスの右にあるアイコンをクリックして、URLをクリップボードにコピーします

    ![画面ショット](007.webp)

1. 別のブラウザを開き、コピーしたURLをアドレスバーにペーストします

    > **TIPS**  
    > 同じブラウザでもOKですが、OCIコンソールを操作しているものとは異なるブラウザ(例えば現在使用しているブラウザがFirefoxならChrome)を立ち上げることで、Oracle Cloud Infrastructure の認証をスキップしていることがより明確に理解できます

    ![画面ショット](008.webp)

    ファイルがダウンロードされ、事前認証済リクエストが正しく機能していることが確認できます

    > **TIPS**  
    > ブラウザからアクセスした場合にファイルのダウンロードが行われず、ウィンドウ内で情報が表示される場合があります。
    > アクセス時の挙動については、ファイルタイプとブラウザの設定に依存します。

1. 作成済み事前認証済リクエストを確認します
コンソール画面に戻り、左下メニューから **事前認証済リクエスト** リンクを選択します。下部に先ほど作成した事前認証済リクエストが表示されます。

    ![画面ショット](009.webp)

1. 右側の赤い ・・・ メニューから **削除** を選択し、先ほど作成した事前認証済リクエストを削除します

1. 先ほどファイルをダウンロードした、別のブラウザに戻り、リロードボタンを押して再度ファイルのダウンロードを試みます

1. 以下のようなエラーメッセージが表示され、認証が拒否されたことを確認します

    ```{"code":"NotAuthenticated","message":"The required information to complete authentication was not provided."}```

    ![画面ショット](010.webp)

以上で、この章の作業は終了です。
