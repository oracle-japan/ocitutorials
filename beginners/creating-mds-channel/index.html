<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="ja-JP" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>その13 - MySQL Database Serviceでレプリケーションを使用する | Oracle Cloud Infrastructure チュートリアル</title>
<meta name="description" content="MySQL Database ServiceではMySQLのレプリケーション機能も使用できます。レプリケーション(チャネル)フィルターを活用することでAmazon RDSなど他社製のMySQLマネージドサービスからレプリケーションすることもできます。レプリケーションの構成方法を確認してみましょう！">


  <meta name="author" content="Oracle Japan Solution Engineers">
  
  <meta property="article:author" content="Oracle Japan Solution Engineers">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="ja_JP">
<meta property="og:site_name" content="Oracle Cloud Infrastructure チュートリアル">
<meta property="og:title" content="その13 - MySQL Database Serviceでレプリケーションを使用する">
<meta property="og:url" content="https://oracle-japan.github.io/ocitutorials/beginners/creating-mds-channel/">


  <meta property="og:description" content="MySQL Database ServiceではMySQLのレプリケーション機能も使用できます。レプリケーション(チャネル)フィルターを活用することでAmazon RDSなど他社製のMySQLマネージドサービスからレプリケーションすることもできます。レプリケーションの構成方法を確認してみましょう！">



  <meta property="og:image" content="https://oracle-japan.github.io/ocitutorials/beginners/creating-mds-readreplica/MySQLLogo_overlay_image.png">





  <meta property="article:published_time" content="2024-09-30T16:51:45+09:00">






<link rel="canonical" href="https://oracle-japan.github.io/ocitutorials/beginners/creating-mds-channel/">












<!-- end _includes/seo.html -->



  <link href="/ocitutorials/feed.xml" type="application/atom+xml" rel="alternate" title="Oracle Cloud Infrastructure チュートリアル Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script type="text/javascript">
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/ocitutorials/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<link rel="icon" href="https://www.oracle.com/asset/web/favicons/favicon-32.png" sizes="32x32">
<link rel="icon" href="https://www.oracle.com/asset/web/favicons/favicon-128.png" sizes="128x128">
<link rel="icon" href="https://www.oracle.com/asset/web/favicons/favicon-192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://www.oracle.com/asset/web/favicons/favicon-120.png" sizes="120x120">
<link rel="apple-touch-icon" href="https://www.oracle.com/asset/web/favicons/favicon-152.png" sizes="152x152">
<link rel="apple-touch-icon" href="https://www.oracle.com/asset/web/favicons/favicon-180.png" sizes="180x180">
<link rel="shortcut icon" type="image/x-icon" href="/ocitutorials/assets/favicon/favicon.ico">
<link rel="manifest" href="/ocitutorials/assets/favicon/site.webmanifest">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/ocitutorials/"><img src="/ocitutorials/assets/images/social-og-oracle-badge.jpg" alt="OCI チュートリアル"></a>
        
        <a class="site-title" href="/ocitutorials/">
          OCI チュートリアル
          <span class="site-subtitle">Oracle Cloud Infrastructure を使ってみよう</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/ocitutorials/#%E3%83%81%E3%83%A5%E3%83%BC%E3%83%88%E3%83%AA%E3%82%A2%E3%83%AB%E3%82%B3%E3%83%B3%E3%83%86%E3%83%B3%E3%83%84%E4%B8%80%E8%A6%A7"
                
                
              >チュートリアル一覧</a>
            </li><li class="masthead__menu-item">
              <a
                href="/ocitutorials/about/"
                
                
              >このサイトについて</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">メニュー</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero--overlay"
  style=" background-image: linear-gradient(rgba(34, 66, 55, 0.7), rgba(34, 66, 55, 0.7)), url('/ocitutorials/beginners/creating-mds-readreplica/MySQLLogo_overlay_image.png');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          その13 - MySQL Database Serviceでレプリケーションを使用する

        
      </h1>
      
        <p class="page__lead">MySQL Database ServiceではMySQLのレプリケーション機能も使用できます。レプリケーション(チャネル)フィルターを活用することでAmazon RDSなど他社製のMySQLマネージドサービスからレプリケーションすることもできます。レプリケーションの構成方法を確認してみましょう！
</p>
      
      


      
    </div>
  
  
</div>






  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/ocitutorials/" itemprop="item"><span itemprop="name">ホーム</span></a>

          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">></span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/ocitutorials/beginners" itemprop="item"><span itemprop="name">Beginners</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">></span>
      
    
      
      
        <li class="current">その13 - MySQL Database Serviceでレプリケーションを使用する</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">メニュー</label>
  <ul class="nav__items">
    <li>
      
      <a href=""><span class="nav__sub-title">入門編</span></a>
      <ul>
        
        
          <p></p><li><a href="/ocitutorials/beginners/acquiring-free-trial/">準備 - Oracle Cloud 無料トライアルを申し込む</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/getting-started/">その1 - OCIコンソールにアクセスして基本を理解する</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/creating-vcn/">その2 - クラウドに仮想ネットワーク(VCN)を作る</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/creating-compute-instance/">その3 - インスタンスを作成する</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/attaching-block-volume/">その4 - ブロック・ボリュームをインスタンスにアタッチする</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/managing-instance-lifecycle/">その5 - インスタンスのライフサイクルを管理する</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/using-file-storage/">その6 - ファイルストレージサービス(FSS)で共有ネットワークボリュームを利用する</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/object-storage/">その7 - オブジェクト・ストレージを使う</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/using-oracle-database/">その8 - クラウドでOracle Databaseを使う</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/creating-mds/">その9 - クラウドでMySQL Databaseを使う</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/creating-HeatWave/">その10 - MySQLで高速分析を体験する</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/creating-mds-ha/">その11 - クラウドでMySQL Databaseを高可用性構成で使う</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/creating-mds-readreplica/">その12 - MySQL Database Serviceでリードレプリカを構成する</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/creating-mds-channel/" class="active">その13 - MySQL Database Serviceでレプリケーションを使用する</a></li></p>
        
          <p></p><li><a href="/ocitutorials/beginners/alwaysfree/">Always Freeで快適DBアプリ開発環境を構築する</a></li></p>
        
      </ul>
    </li>
  </ul>
</nav>
    
  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="その13 - MySQL Database Serviceでレプリケーションを使用する">
    <meta itemprop="description" content="MySQL Database ServiceではMySQLのレプリケーション機能も使用できます。レプリケーション(チャネル)フィルターを活用することでAmazon RDSなど他社製のMySQLマネージドサービスからレプリケーションすることもできます。レプリケーションの構成方法を確認してみましょう！">
    <meta itemprop="datePublished" content="2024-09-30T16:51:45+09:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> 目次</h4></header>
              <ul class="toc__menu"><li><a href="#1-レプリケーションとは">1. レプリケーションとは?</a></li><li><a href="#2-本チュートリアルで作成する構成の構成図">2. 本チュートリアルで作成する構成の構成図</a></li><li><a href="#3-mdsの作成ソース用のmdsレプリカ用のmds">3. MDSの作成(ソース用のMDS、レプリカ用のMDS)</a></li><li><a href="#4-レプリケーション用ユーザーの作成ソース用のmdsレプリカ用のmds">4. レプリケーション用ユーザーの作成(ソース用のMDS、レプリカ用のMDS)</a></li><li><a href="#5-ソース用mdsのデータをダンプしレプリカ用mdsへインポート">5. ソース用MDSのデータをダンプし、レプリカ用MDSへインポート</a></li><li><a href="#6-レプリケーションチャンネルの設定">6. レプリケーションチャンネルの設定</a></li><li><a href="#7-レプリケーションの動作確認">7. レプリケーションの動作確認</a></li><li><a href="#8-レプリケーションフィルターチャネルフィルターの設定">8. レプリケーションフィルター(チャネルフィルター)の設定</a></li><li><a href="#9-レプリケーションフィルターチャネルフィルターの動作確認">9. レプリケーションフィルター(チャネルフィルター)の動作確認</a></li></ul>
            </nav>
          </aside>
        
        <p>Oracle Cloud Infrastructure では、MySQL Database Service(MDS)が利用できます。MDSはAlways Freeの対象ではないため、使用するためにはクレジットが必要ですが、トライアルアカウント作成時に付与されるクレジットでも使用可能です。</p>

<p>このチュートリアルでは、MDSからMDSへのレプリケーションを構成することで、MDSでのレプリケーションの構成方法を確認します。MDSはソースにもレプリカにもなれますが、マネージドサービスであるが故の注意事項や制限事項もあるため、それらについても説明します。</p>

<p><strong>所要時間 :</strong> 約50分 (約20分の待ち時間含む)</p>

<p><strong>前提条件 :</strong></p>

<ol>
  <li>Oracle Cloud Infrastructure の環境(無料トライアルでも可) と、管理権限を持つユーザーアカウントがあること</li>
  <li><a href="../getting-started/">OCIコンソールにアクセスして基本を理解する - Oracle Cloud Infrastructureを使ってみよう(その1)</a> を完了していること</li>
  <li><a href="../creating-vcn/">クラウドに仮想ネットワーク(VCN)を作る - Oracle Cloud Infrastructureを使ってみよう(その2)</a> を完了していること</li>
  <li><a href="../creating-compute-instance/">インスタンスを作成する - Oracle Cloud Infrastructureを使ってみよう(その3)</a> を完了していること</li>
</ol>

<p><strong>注意 :</strong> チュートリアル内の画面ショットについては Oracle Cloud Infrastructure の現在のコンソール画面と異なっている場合があります。
<br /></p>

<p><strong>目次：</strong></p>

<ul>
  <li><a href="#anchor1">1. レプリケーションとは?</a></li>
  <li><a href="#anchor2">2. 本チュートリアルで作成する構成の構成図</a></li>
  <li><a href="#anchor3">3. MDSの作成(ソース用のMDS、レプリカ用のMDS)</a></li>
  <li><a href="#anchor4">4. レプリケーション用ユーザーの作成(ソース用のMDS、レプリカ用のMDS)</a></li>
  <li><a href="#anchor5">5. ソース用MDSのデータをダンプし、レプリカ用MDSへインポート</a></li>
  <li><a href="#anchor6">6. レプリケーションチャンネルの設定</a></li>
  <li><a href="#anchor7">7. レプリケーションの動作確認</a></li>
  <li><a href="#anchor8">8. レプリケーションフィルター(チャネルフィルター)の設定＆動作確認</a></li>
  <li><a href="#anchor9">9. レプリケーションフィルター(チャネルフィルター)の動作確認</a>
<br /></li>
</ul>

<p><a id="anchor1"></a></p>

<h1 id="1-レプリケーションとは">1. レプリケーションとは?</h1>

<p>レプリケーションはMySQLで非常に人気が高い機能で、ソースサーバーでの更新内容をレプリカサーバーに伝播できます。レプリケーションは主に高可用性や負荷分散を実現するために利用されます。</p>

<p>MDSは、レプリケーションを利用してソースになることもレプリカになることもできます。MDSがソースになる場合のレプリケーションを<a href="https://docs.oracle.com/ja-jp/iaas/mysql-database/doc/outbound-replication.html">アウトバウンドレプリケーション</a>、MDSがレプリカになる場合のレプリケーションを<a href="https://docs.oracle.com/ja-jp/iaas/mysql-database/doc/inbound-replication.html">インバウンドレプリケーション</a>と言います。それぞれの詳細についてはドキュメントを参照して下さい。</p>

<p>なお、インバウンドレプリケーションでは、以下の制限事項があります。</p>

<ul>
  <li>行ベースレプリケーションのみサポート</li>
  <li>非同期レプリケーションのみサポート</li>
  <li>シングルソースレプリケーションのみサポート</li>
  <li>mysqlスキーマに対する更新処理はレプリケーションできない</li>
</ul>

<p>また、HA構成のMDSではインバウンドレプリケーションを構成できませんが、シングル構成のMDSでインバウンドレプリケーションを構成後、そのMDSをHA構成に変更することでHA構成のMDSでもインバウンドレプリケーションを使用できます。
<br />
<br /></p>

<p><a id="anchor2"></a></p>

<h1 id="2-本チュートリアルで作成する構成の構成図">2. 本チュートリアルで作成する構成の構成図</h1>

<p>本チュートリアルでは、以下の構成を作成します。</p>

<div align="center">
<img width="900" alt="img_diagram.png" src="img_diagram.png" style="border: 1px black solid;" />
</div>
<p><br /></p>

<p><a id="anchor3"></a></p>

<h1 id="3-mdsの作成ソース用のmdsレプリカ用のmds">3. MDSの作成(ソース用のMDS、レプリカ用のMDS)</h1>

<ol>
  <li>
    <p>ソース用のMDSを作成します。<a href="../creating-mds/">クラウドでMySQL Databaseを使う - Oracle Cloud Infrastructureを使ってみよう(その9)</a> の手順に従って「Source」という名前でソース用のMDSを作成します。「2. MDSの作成」だけでなく、「3. セキュリティリストの修正(イングレス・ルールの追加)」、「4. MySQLクライアントのインストール」、「5. 作成したMDSの確認」まで実行し、worldデータベース、world_xデータベースも作成しておきます。</p>
  </li>
  <li>
    <p>レプリカ用のMDSを作成します。<a href="../creating-mds/">クラウドでMySQL Databaseを使う - Oracle Cloud Infrastructureを使ってみよう(その9)</a> の「2. MDSの作成」の手順に従って「Replica」という名前でレプリカ用のMDSを作成します。
(「2. MDSの作成」より後の手順は実行不要です)</p>
  </li>
</ol>

<p><br /></p>

<p><a id="anchor4"></a></p>

<h1 id="4-レプリケーション用ユーザーの作成ソース用のmdsレプリカ用のmds">4. レプリケーション用ユーザーの作成(ソース用のMDS、レプリカ用のMDS)</h1>

<ol>
  <li>
    <p>レプリケーション用のユーザーを作成し、REPLICATION SLAVE権限を付与します。以下の操作は、ソース用のMDS、レプリカ用のMDSの両方で実行します。</p>

    <p>実行コマンド例(コピー＆ペースト用：Source 及び Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> CREATE USER 'rpl'@'%' IDENTIFIED BY 'MySQL_8.0' REQUIRE SSL;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> GRANT REPLICATION SLAVE on *.* to 'rpl'@'%';
</code></pre></div>    </div>

    <p>実行例 (Source 及び Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mysql&gt; CREATE USER 'rpl'@'%' IDENTIFIED BY 'MySQL_8.0' REQUIRE SSL;
 Query OK, 0 rows affected (0.00 sec)

 mysql&gt; GRANT REPLICATION SLAVE on *.* to 'rpl'@'%';
 Query OK, 0 rows affected (0.00 sec)
</code></pre></div>    </div>
    <p><br /></p>
  </li>
</ol>

<p><a id="anchor5"></a></p>

<h1 id="5-ソース用mdsのデータをダンプしレプリカ用mdsへインポート">5. ソース用MDSのデータをダンプし、レプリカ用MDSへインポート</h1>

<p>レプリケーションを構成する前に、ソース用のDBとレプリカ用のDBを同じ状態にします。このチュートリアルでは、ソース用DBのデータを<a href="https://dev.mysql.com/doc/mysql-shell/8.0/ja/mysql-shell-utilities-dump-instance-schema.html">MySQL Shellのデータダンプユーリティティ</a>を使用してダンプし、それをレプリカ用DBにインポートします。</p>

<ol>
  <li>
    <p>ソース用のMDSにMySQL Shellを使用して接続し、インスタンスダンプユーリティティを使用してデータをダンプします。MDSにデータをインポートするためには、MDSとの互換性を確保したダンプファイルを取得する必要があるため、ocimdsオプションをtrueにしてデータをダンプします。また、dryRunオプションをtrueにすることでダンプは取得せずにMDSとの互換性チェックの結果を表示できるため、まずはこれらのオプションをtrueにしてインスタンスダンプユーティリティを実行します。</p>

    <p>実行コマンド例(コピー＆ペースト用)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mysqlsh -u root -p -h Source.sub01311142371.tutorialvcn.oraclevcn.com
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> util.dumpInstance("/home/opc/mds", {dryRun: true, ocimds: true})
</code></pre></div>    </div>

    <p>実行例：MySQL Shellを使ってソースのMDSに接続</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> [opc@testvm1 ~]$ mysqlsh -u root -p -h Source.sub01311142371.tutorialvcn.oraclevcn.com
 MySQL Shell 8.0.32

 Copyright (c) 2016, 2023, Oracle and/or its affiliates.
 Oracle is a registered trademark of Oracle Corporation and/or its affiliates.
 Other names may be trademarks of their respective owners.

 Type '\help' or '\?' for help; '\quit' to exit.
 Creating a session to 'root@TestMDS.sub01311142371.tutorialvcn.oraclevcn.com'
 Fetching schema names for auto-completion... Press ^C to stop.
 Your MySQL connection id is 246
 Server version: 8.0.32-cloud MySQL Enterprise - Cloud
 No default schema selected; type \use &lt;schema&gt; to set one.
</code></pre></div>    </div>

    <p>実行例：インスタンスダンプユーティリティを実行 (Source で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  JS &gt; util.dumpInstance("/home/opc/mds", {dryRun: true, ocimds: true})
 dryRun enabled, no locks will be acquired and no files will be created.
 Acquiring global read lock
 Global read lock acquired
 Initializing - done 
 2 out of 6 schemas will be dumped and within them 7 tables, 0 views.
 5 out of 8 users will be dumped.
 Gathering information - done 
 All transactions have been started
 Locking instance for backup
 Global read lock has been released
 Checking for compatibility with MySQL Database Service 8.0.32
 ERROR: User 'administrator'@'%' is granted restricted privileges: BACKUP_ADMIN, FLUSH_OPTIMIZER_COSTS, FLUSH_STATUS, FLUSH_TABLES, FLUSH_USER_RESOURCES, ROLE_ADMIN (fix this with 'strip_restricted_grants' compatibility option)
 ERROR: User 'ociadmin'@'127.0.0.1' is granted restricted privileges: AUDIT_ABORT_EXEMPT, AUDIT_ADMIN, AUTHENTICATION_POLICY_ADMIN, BACKUP_ADMIN, BINLOG_ADMIN, BINLOG_ENCRYPTION_ADMIN, CLONE_ADMIN, CREATE TABLESPACE, ENCRYPTION_KEY_ADMIN, FILE, FIREWALL_EXEMPT, FLUSH_OPTIMIZER_COSTS, FLUSH_STATUS, FLUSH_TABLES, FLUSH_USER_RESOURCES, GROUP_REPLICATION_ADMIN, GROUP_REPLICATION_STREAM, INNODB_REDO_LOG_ARCHIVE, INNODB_REDO_LOG_ENABLE, PASSWORDLESS_USER_ADMIN, PERSIST_RO_VARIABLES_ADMIN, PROXY, RELOAD, REPLICATION_SLAVE_ADMIN, ROLE_ADMIN, SENSITIVE_VARIABLES_OBSERVER, SERVICE_CONNECTION_ADMIN, SESSION_VARIABLES_ADMIN, SET_USER_ID, SHOW_ROUTINE, SHUTDOWN, SUPER, SYSTEM_USER, SYSTEM_VARIABLES_ADMIN, TABLE_ENCRYPTION_ADMIN (fix this with 'strip_restricted_grants' compatibility option)
 ERROR: User 'ocirpl'@'%' is granted restricted privileges: SERVICE_CONNECTION_ADMIN, SYSTEM_USER (fix this with 'strip_restricted_grants' compatibility option)
 ERROR: User 'root'@'%' is granted restricted privileges: BACKUP_ADMIN, FLUSH_OPTIMIZER_COSTS, FLUSH_STATUS, FLUSH_TABLES, FLUSH_USER_RESOURCES, PROXY, ROLE_ADMIN (fix this with 'strip_restricted_grants' compatibility option)
 NOTE: Database `world` had unsupported ENCRYPTION option commented out
 NOTE: Database `world_x` had unsupported ENCRYPTION option commented out
 Compatibility issues with MySQL Database Service 8.0.32 were found. Please use the 'compatibility' option to apply compatibility adaptations to the dumped DDL.
 Validating MDS compatibility - done       
 Util.dumpInstance: While 'Validating MDS compatibility': Compatibility issues were found (MYSQLSH 52004)
</code></pre></div>    </div>

    <p>ERRORが4つ出力されていますが、いずれもMDSでユーザーに付与できない権限が付与されたユーザーが存在することが原因です。本チュートリアルにの手順では、ユーザー情報はインポートする必要がないため、表示されているメッセージ「fix this with ‘strip_restricted_grants’ compatibility option」に従い、compatibilityに’strip_restricted_grants’を指定して回避します。
 <br /></p>
  </li>
  <li>
    <p>先ほど実行したコマンドにcompatibilityオプションを追加し、’strip_restricted_grants’を指定します。また、dryRunオプションをfalseにして実行します。</p>

    <p>実行コマンド(コピー＆ペースト用：Source で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> util.dumpInstance("/home/opc/mds", {ocimds: true, compatibility: ["strip_restricted_grants"]})
 \quit
</code></pre></div>    </div>

    <p>実行例 (Source で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  JS &gt; util.dumpInstance("/home/opc/mds", {ocimds: true, compatibility: ["strip_restricted_grants"]})
 Acquiring global read lock
 Global read lock acquired
 Initializing - done 
 2 out of 6 schemas will be dumped and within them 7 tables, 0 views.
 5 out of 8 users will be dumped.
 Gathering information - done 
 All transactions have been started
 Locking instance for backup
 Global read lock has been released
 Checking for compatibility with MySQL Database Service 8.0.32
 NOTE: User 'administrator'@'%' had restricted privileges (BACKUP_ADMIN, FLUSH_OPTIMIZER_COSTS, FLUSH_STATUS, FLUSH_TABLES, FLUSH_USER_RESOURCES, ROLE_ADMIN) removed
 NOTE: User 'ociadmin'@'127.0.0.1' had restricted privileges (AUDIT_ABORT_EXEMPT, AUDIT_ADMIN, AUTHENTICATION_POLICY_ADMIN, BACKUP_ADMIN, BINLOG_ADMIN, BINLOG_ENCRYPTION_ADMIN, CLONE_ADMIN, CREATE TABLESPACE, ENCRYPTION_KEY_ADMIN, FILE, FIREWALL_EXEMPT, FLUSH_OPTIMIZER_COSTS, FLUSH_STATUS, FLUSH_TABLES, FLUSH_USER_RESOURCES, GROUP_REPLICATION_ADMIN, GROUP_REPLICATION_STREAM, INNODB_REDO_LOG_ARCHIVE, INNODB_REDO_LOG_ENABLE, PASSWORDLESS_USER_ADMIN, PERSIST_RO_VARIABLES_ADMIN, PROXY, RELOAD, REPLICATION_SLAVE_ADMIN, ROLE_ADMIN, SENSITIVE_VARIABLES_OBSERVER, SERVICE_CONNECTION_ADMIN, SESSION_VARIABLES_ADMIN, SET_USER_ID, SHOW_ROUTINE, SHUTDOWN, SUPER, SYSTEM_USER, SYSTEM_VARIABLES_ADMIN, TABLE_ENCRYPTION_ADMIN) removed
 NOTE: User 'ocirpl'@'%' had restricted privileges (SERVICE_CONNECTION_ADMIN, SYSTEM_USER) removed
 NOTE: User 'root'@'%' had restricted privileges (BACKUP_ADMIN, FLUSH_OPTIMIZER_COSTS, FLUSH_STATUS, FLUSH_TABLES, FLUSH_USER_RESOURCES, PROXY, ROLE_ADMIN) removed
 NOTE: Database `world_x` had unsupported ENCRYPTION option commented out
 NOTE: Database `world` had unsupported ENCRYPTION option commented out
 Compatibility issues with MySQL Database Service 8.0.32 were found and repaired. Please review the changes made before loading them.
 Validating MDS compatibility - done       
 Writing global DDL files
 Writing users DDL
 Running data dump using 4 threads.
 NOTE: Progress information uses estimated values and may not be accurate.
 Writing schema metadata - done       
 Writing DDL - done       
 Writing table metadata - done       
 Starting data dump
 100% (10.84K rows / ~10.80K rows), 0.00 rows/s, 0.00 B/s uncompressed, 0.00 B/s compressed
 Dump duration: 00:00:00s                                                                  
 Total duration: 00:00:00s                                                                 
 Schemas dumped: 2                                                                         
 Tables dumped: 7                                                                          
 Uncompressed data size: 514.22 KB                                                         
 Compressed data size: 188.81 KB                                                           
 Compression ratio: 2.7                                                                    
 Rows written: 10843                                                                       
 Bytes written: 188.81 KB                                                                  
 Average uncompressed throughput: 514.22 KB/s                                              
 Average compressed throughput: 188.81 KB/s
  JS &gt;  \quit
 Bye!
</code></pre></div>    </div>
    <p><br /></p>
  </li>
  <li>
    <p>“/home/opc/mds”配下にダンプされたファイルが出力されていることを確認後、ダンプロードユーティリティをレプリカサーバーで実行するために、MySQL Shellを使ってレプリカサーバーに接続します。</p>

    <p>実行コマンド例(コピー＆ペースト用：TestVM1 で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ls mds
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mysqlsh -u root -p -h Replica.sub01311142371.tutorialvcn.oraclevcn.com
</code></pre></div>    </div>

    <p>実行例 (TestVM1 で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> [opc@testvm1 ~]$ ls mds
 @.done.json                           world_x@city@@0.tsv.zst
 @.json                                world_x@city@@0.tsv.zst.idx
 @.post.sql                            world_x@city.json
 @.sql                                 world_x@city.sql
 @.users.sql                           world_x@country@@0.tsv.zst
 world@city@@0.tsv.zst                 world_x@country@@0.tsv.zst.idx
 world@city@@0.tsv.zst.idx             world_x@countryinfo@@0.tsv.zst
 world@city.json                       world_x@countryinfo@@0.tsv.zst.idx
 world@city.sql                        world_x@countryinfo.json
 world@country@@0.tsv.zst              world_x@countryinfo.sql
 world@country@@0.tsv.zst.idx          world_x@country.json
 world@country.json                    world_x@countrylanguage@@0.tsv.zst
 world@countrylanguage@@0.tsv.zst      world_x@countrylanguage@@0.tsv.zst.idx
 world@countrylanguage@@0.tsv.zst.idx  world_x@countrylanguage.json
 world@countrylanguage.json            world_x@countrylanguage.sql
 world@countrylanguage.sql             world_x@country.sql
 world@country.sql                     world_x.json
 world.json                            world_x.sql
 world.sql
 [opc@testvm1 ~]$ mysqlsh -u root -p -h Replica.sub01311142371.tutorialvcn.oraclevcn.com
 MySQL Shell 8.0.32

 Copyright (c) 2016, 2023, Oracle and/or its affiliates.
 Oracle is a registered trademark of Oracle Corporation and/or its affiliates.
 Other names may be trademarks of their respective owners.

 Type '\help' or '\?' for help; '\quit' to exit.
 Creating a session to 'root@TestMDS2.sub01311142371.tutorialvcn.oraclevcn.com'
 Fetching schema names for auto-completion... Press ^C to stop.
 Your MySQL connection id is 404
 Server version: 8.0.32-cloud MySQL Enterprise - Cloud
 No default schema selected; type \use &lt;schema&gt; to set one.
  JS &gt; 
</code></pre></div>    </div>
    <p><br /></p>
  </li>
  <li>
    <p>ダンプロードユーティリティを使って、レプリカサーバーにデータをインポートします。今回の手順ではユーザー情報はインポートする必要がないため、loadUsersオプションはfalseに設定して実行します。また、ダンプ取得時のソースサーバーのGTIDをレプリカサーバーに設定するためにupdateGtidSetオプションを”append”にして実行します。</p>

    <p>実行コマンド(コピー＆ペースト用：Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> util.loadDump("/home/opc/mds", {loadUsers: false, updateGtidSet: "append"});
</code></pre></div>    </div>

    <p>実行例 (Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  JS &gt; util.loadDump("/home/opc/mds", {loadUsers: false, updateGtidSet: "append"});
 Loading DDL and Data from '/home/opc/mds' using 4 threads.
 Opening dump...
 Target is MySQL 8.0.32-cloud (MySQL Database Service). Dump was produced from MySQL 8.0.32-cloud
 Scanning metadata - done       
 Checking for pre-existing objects...
 Executing common preamble SQL
 Executing DDL - done       
 Executing view DDL - done       
 Starting data load
 Executing common postamble SQL                       
 Appending dumped gtid set to GTID_PURGED             
 100% (514.22 KB / 514.22 KB), 0.00 B/s, 7 / 7 tables done             
 Recreating indexes - done 
 7 chunks (10.84K rows, 514.22 KB) for 7 tables in 2 schemas were loaded in 0 sec (avg throughput 514.22 KB/s)
 0 warnings were reported during the load.
</code></pre></div>    </div>
    <p><br /></p>
  </li>
  <li>
    <p>MySQL ShellをSQLモードに変更し、レプリカサーバーにデータがインポートされたことを確認します。</p>

    <p>実行コマンド(コピー＆ペースト用：Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> \sql
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SHOW DATABASES;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> USE world;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SHOW TABLES;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> USE world_x;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SHOW TABLES;
</code></pre></div>    </div>

    <p>実行例 (Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  JS &gt; \sql
 Switching to SQL mode... Commands end with ;
 Fetching global names for auto-completion... Press ^C to stop.
  SQL &gt; SHOW DATABASES;
 +--------------------+
 | Database           |
 +--------------------+
 | information_schema |
 | mysql              |
 | performance_schema |
 | sys                |
 | world              |
 | world_x            |
 +--------------------+
 6 rows in set (0.0010 sec)
  SQL &gt;  USE world;
 Default schema set to `world`.
 Fetching global names, object names from `world` for auto-completion... Press ^C to stop.
  world  SQL &gt;  SHOW TABLES;
 +-----------------+
 | Tables_in_world |
 +-----------------+
 | city            |
 | country         |
 | countrylanguage |
 +-----------------+
 3 rows in set (0.0018 sec)
  SQL &gt; USE world_x;
 Default schema set to `world_x`.
 Fetching global names, object names from `world_x` for auto-completion... Press ^C to stop.
  world_x  SQL &gt; SHOW TABLES;
 +-------------------+
 | Tables_in_world_x |
 +-------------------+
 | city              |
 | country           |
 | countryinfo       |
 | countrylanguage   |
 +-------------------+
 4 rows in set (0.0017 sec)
</code></pre></div>    </div>
    <p><br /></p>
  </li>
</ol>

<p><a id="anchor6"></a></p>

<h1 id="6-レプリケーションチャンネルの設定">6. レプリケーションチャンネルの設定</h1>

<ol>
  <li>
    <p>コンソールからレプリカ用のMDS(Replica)の詳細にアクセス後、左下の<strong>チャネル</strong>をクリックします。その後、<strong>チャネルの作成</strong>をクリックします。</p>

    <div align="center">
 <img width="700" alt="img1.png" src="img1.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>

    <div align="center">
 <img width="700" alt="img2.png" src="img2.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>
  </li>
  <li>
    <p>表示された「チャネルの作成」画面で、以下の項目を入力後、「チャネルの作成」をクリックします。</p>

    <ul>
      <li><strong>名前</strong> - 任意の名前を入力します。ここでは「TestChannel」と入力しています。</li>
      <li><strong>ホスト名</strong> - ソースのMDSのホスト名(内部FQDN)もしくはプライベートIPアドレスを入力します。</li>
      <li><strong>ユーザー名</strong> - ソースのMDSに作成したレプリケーション用ユーザー名を入力します。ここでは「rpl」を入力しています。</li>
      <li><strong>パスワード</strong>、<strong>パスワードの確認</strong> - ソースのMDSに作成したレプリケーション用ユーザーのパスワードを入力します。</li>
    </ul>

    <div align="center">
 <img width="700" alt="img3.png" src="img3.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>

    <div align="center">
 <img width="700" alt="img4.png" src="img4.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>

    <div align="center">
 <img width="700" alt="img5.png" src="img5.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>
  </li>
  <li>
    <p>チャネルが「作成中」になり、数分後に「アクティブ」に変わります。</p>

    <div align="center">
 <img width="700" alt="img6.png" src="img6.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>

    <div align="center">
 <img width="700" alt="img7.png" src="img7.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>
  </li>
</ol>

<p><a id="anchor7"></a></p>

<h1 id="7-レプリケーションの動作確認">7. レプリケーションの動作確認</h1>
<p>ソース用のMDSで更新処理を実行し、レプリカ用のMDSに反映されることを確認します。</p>

<ol>
  <li>
    <p>ソース用のMDSにmysqlコマンドラインクライアントを使用して接続し、testデータベース、test.testテーブルを作成し、データをINSERTします。その後、レプリカ用のMDSでtest.testテーブルが存在することを確認し、INSERTされたデータがSELECTできることを確認します。以下の実行例ではそれぞれのMDSでの操作をまとめて掲載していますが、コンソールを2つ開いてそれぞれSourceとReplicaに接続し、1ステップずつ実行することで、各ステップ毎にリードレプリカに処理内容がレプリケーションされていることが確認できます。</p>

    <p>実行コマンド(コピー＆ペースト用：Source で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> CREATE DATABASE rpl;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> CREATE TABLE rpl.test(id int AUTO_INCREMENT, col1 CHAR(10), PRIMARY KEY(id));
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> INSERT INTO rpl.test VALUES(1, "TEST");
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT * FROM rpl.test;
</code></pre></div>    </div>

    <p>実行コマンド(コピー＆ペースト用：Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SHOW DATABASES;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> USE rpl;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SHOW TABLES;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT * FROM rpl.test;
</code></pre></div>    </div>
    <p><br /></p>

    <p>実行例 (Source で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mysql&gt; CREATE DATABASE rpl;
 Query OK, 1 row affected (0.01 sec)

 mysql&gt; CREATE TABLE rpl.test(id int AUTO_INCREMENT, col1 CHAR(10), PRIMARY KEY(id));
 Query OK, 0 rows affected (0.00 sec)

 mysql&gt; INSERT INTO rpl.test VALUES(1, "TEST");
 Query OK, 1 row affected (0.00 sec)

 mysql&gt; SELECT * FROM rpl.test;
 +----+------+
 | id | col1 |
 +----+------+
 |  1 | TEST |
 +----+------+
 1 row in set (0.00 sec)
</code></pre></div>    </div>

    <p>実行例 (Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mysql&gt; SHOW DATABASES;
 +--------------------+
 | Database           |
 +--------------------+
 | information_schema |
 | mysql              |
 | performance_schema |
 | sys                |
 | rpl                |
 | world              |
 | world_x            |
 +--------------------+
 7 rows in set (0.00 sec)

 mysql&gt; USE rpl;
 Reading table information for completion of table and column names
 You can turn off this feature to get a quicker startup with -A

 Database changed
 mysql&gt; SHOW TABLES;
 +----------------+
 | Tables_in_test |
 +----------------+
 | test           |
 +----------------+
 1 row in set (0.00 sec)

 mysql&gt; SELECT * FROM rpl.test;
 +----+------+
 | id | col1 |
 +----+------+
 |  1 | TEST |
 +----+------+
 1 row in set (0.00 sec)
</code></pre></div>    </div>
    <p><br /></p>
  </li>
</ol>

<p><a id="anchor8"></a></p>

<h1 id="8-レプリケーションフィルターチャネルフィルターの設定">8. レプリケーションフィルター(チャネルフィルター)の設定</h1>
<p>レプリケーションフィルター(チャネルフィルター)を設定し、特定のデータベース/テーブルのみレプリケーションできることを確認します。まずはレプリケーションフィルターを設定します。</p>

<ol>
  <li>
    <p>コンソールからレプリカ用のMDS(Replica)の詳細にアクセス後、左下の<strong>チャネル</strong>をクリックします。その後、<strong>TestChannel</strong>をクリックします。</p>

    <div align="center">
 <img width="700" alt="img1.png" src="img1.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>

    <div align="center">
 <img width="700" alt="img8.png" src="img8.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>
  </li>
  <li>
    <p><strong>編集</strong>をクリックし、「ターゲットDBシステム」部分の<strong>チャネル・フィルタ・オプションの表示</strong>をクリックします。</p>

    <div align="center">
 <img width="700" alt="img9.png" src="img9.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>

    <div align="center">
 <img width="700" alt="img10.png" src="img10.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>
  </li>
  <li>
    <p>入力欄が表示されていない場合は、<strong>別のフィルタの追加</strong>をクリックします。そして、「タイプ」のプルダウンから<strong>REPLICATE_DO_DATABASE</strong>を選択し、「値」に<strong>world</strong>と入力し、<strong>変更の保存</strong>をクリックします。</p>

    <div align="center">
 <img width="700" alt="img11.png" src="img11.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>

    <div align="center">
 <img width="700" alt="img12.png" src="img12.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>

    <div align="center">
 <img width="700" alt="img13.png" src="img13.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>
  </li>
  <li>
    <p>チャネルが「更新中」になり、数分後に「アクティブ」に変わります。</p>

    <div align="center">
 <img width="700" alt="img14.png" src="img14.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>

    <div align="center">
 <img width="700" alt="img15.png" src="img15.png" style="border: 1px black solid;" />
 </div>
    <p><br /></p>
  </li>
</ol>

<p><a id="anchor9"></a></p>

<h1 id="9-レプリケーションフィルターチャネルフィルターの動作確認">9. レプリケーションフィルター(チャネルフィルター)の動作確認</h1>
<p>上記ステップで設定したレプリケーションフィルター(チャネルフィルター)の動作を確認します。REPLICATE_DO_DATABASEにworldデータベースを指定しているため、worldデータベースに対する更新のみがレプリケーションされることを確認します。</p>

<ol>
  <li>
    <p>ソース用のMDS(Source)に接続してrpl.testテーブルを更新し、その更新内容がレプリカ用のMDS(Replica)に伝播されないことを確認します。</p>

    <p>実行コマンド(コピー＆ペースト用：Source で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> UPDATE rpl.test SET col1='FILTER' WHERE id=1;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT * FROM rpl.test;
</code></pre></div>    </div>

    <p>実行コマンド(コピー＆ペースト用：Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT * FROM rpl.test;
</code></pre></div>    </div>
    <p><br /></p>

    <p>実行例(Source で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mysql&gt; UPDATE rpl.test SET col1='FILTER' WHERE id=1;
 Query OK, 1 row affected (0.00 sec)
 Rows matched: 1  Changed: 1  Warnings: 0

 mysql&gt; SELECT * FROM rpl.test;
 +----+--------+
 | id | col1   |
 +----+--------+
 |  1 | FILTER |
 +----+--------+
 1 row in set (0.00 sec)
</code></pre></div>    </div>

    <p>実行例(Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mysql&gt; SELECT * FROM rpl.test;
 +----+------+
 | id | col1 |
 +----+------+
 |  1 | TEST |
 +----+------+
 1 row in set (0.00 sec)
</code></pre></div>    </div>
    <p><br /></p>
  </li>
  <li>
    <p>ソース用のMDS(Source)に接続してworld.cityテーブルを更新し、その更新内容がレプリカ用のMDS(Replica)に伝播されることを確認します。</p>

    <p>実行コマンド(コピー＆ペースト用：Source で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT * FROM world.city WHERE ID=1538;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> UPDATE world.city SET Population=1506516 WHERE ID=1538;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT * FROM world.city WHERE ID=1538;
</code></pre></div>    </div>

    <p>実行コマンド(コピー＆ペースト用：Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT * FROM world.city WHERE ID=1538;
</code></pre></div>    </div>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT * FROM world.city WHERE ID=1538;
</code></pre></div>    </div>
    <p><br /></p>

    <p>実行例(Source で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mysql&gt; SELECT * FROM world.city WHERE ID=1538;
 +------+------+-------------+----------+------------+
 | ID   | Name | CountryCode | District | Population |
 +------+------+-------------+----------+------------+
 | 1538 | Kobe | JPN         | Hyogo    |    1425139 |
 +------+------+-------------+----------+------------+
 1 row in set (0.00 sec)

 mysql&gt; UPDATE world.city SET Population=1506516 WHERE ID=1538;
 Query OK, 1 row affected (0.00 sec)
 Rows matched: 1  Changed: 1  Warnings: 0

 mysql&gt; SELECT * FROM world.city WHERE ID=1538;
 +------+------+-------------+----------+------------+
 | ID   | Name | CountryCode | District | Population |
 +------+------+-------------+----------+------------+
 | 1538 | Kobe | JPN         | Hyogo    |    1506516 |
 +------+------+-------------+----------+------------+
 1 row in set (0.00 sec)
</code></pre></div>    </div>

    <p>実行例(Replica で実行)</p>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> mysql&gt; SELECT * FROM world.city WHERE ID=1538;
 +------+------+-------------+----------+------------+
 | ID   | Name | CountryCode | District | Population |
 +------+------+-------------+----------+------------+
 | 1538 | Kobe | JPN         | Hyogo    |    1425139 |
 +------+------+-------------+----------+------------+
 1 row in set (0.00 sec)

 mysql&gt; SELECT * FROM world.city WHERE ID=1538;
 +------+------+-------------+----------+------------+
 | ID   | Name | CountryCode | District | Population |
 +------+------+-------------+----------+------------+
 | 1538 | Kobe | JPN         | Hyogo    |    1506516 |
 +------+------+-------------+----------+------------+
 1 row in set (0.00 sec)    
</code></pre></div>    </div>
    <p><br /></p>
  </li>
</ol>

<p>これで、この章の作業は終了です。</p>

<p>この章では、MDS同士でレプリケーションを構成し、ソースのMDSでの更新内容がレプリカのMDSに反映されることを確認しました。また、レプリケーション(チャネル)フィルターを活用してレプリケーション対象DBを限定し、特定のDBに対してのみレプリケーションできることも確認しました。(テーブルを限定するなど、他にも指定できるフィルタリングルールがあります)</p>

<p>MDS同士のレプリケーションはリードレプリカの制限事項を回避するために使用することもできますが、レプリカ側のMDSを参照専用に設定できないことに注意して下さい。<br />
(MDSでは、RESET MASTER文を実行できないなど、マネージドサービスであることに依存した制限事項が他にもいくつかあります)</p>

<p>他にも、インバウンドレプリケーションを構成して、オンプレミス環境や他社製のMySQLマネージドサービスからレプリケーションを構成し、MySQL HeatWaveを活用して高速にデータを分析することもできます。<br />
(MySQL HeatWaveについては、<a href="../getting-started/">MySQLで高速分析を体験する - Oracle Cloud Infrastructureを使ってみよう(その10)</a>を参照して下さい)</p>

<p>このようにレプリケーション機能は色々な活用方法があります。MDSのレプリケーション機能も是非活用して下さい。</p>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 更新日時:</strong> <time class="dt-published" datetime="2024-09-30T16:51:45+09:00">September 30, 2024</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">共有</h4>
  

  <a href="https://twitter.com/intent/tweet?text=%E3%81%9D%E3%81%AE13+-+MySQL+Database+Service%E3%81%A7%E3%83%AC%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%20https%3A%2F%2Foracle-japan.github.io%2Focitutorials%2Fbeginners%2Fcreating-mds-channel%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="共有 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Foracle-japan.github.io%2Focitutorials%2Fbeginners%2Fcreating-mds-channel%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="共有 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://oracle-japan.github.io/ocitutorials/beginners/creating-mds-channel/" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="共有 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/ocitutorials/beginners/creating-mds-readreplica/" class="pagination--pager" title="その12 - MySQL Database Serviceでリードレプリカを構成する
">前へ</a>
    
    
      <a href="/ocitutorials/beginners/alwaysfree/" class="pagination--pager" title="Always Freeで快適DBアプリ開発環境を構築する
">次へ</a>
    
  </nav>

    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">関連記事</h2>
  <div class="grid__wrapper">
    
  </div>
</div>

  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="検索キーワードを入力してください..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>フォロー</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/#ocijp" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/oracle-japan" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/ocitutorials/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 <a href="https://oracle-japan.github.io">Oracle Cloud Infrastructure チュートリアル</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/ocitutorials/assets/js/main.min.js"></script>




<script src="/ocitutorials/assets/js/lunr/lunr.min.js"></script>
<script src="/ocitutorials/assets/js/lunr/lunr-store.js"></script>
<script src="/ocitutorials/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6W7FEC5CEH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6W7FEC5CEH', { 'anonymize_ip': false});
</script>







  
    <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
  
    <script src="/ocitutorials/assets/js/clipboardrouge.js"></script>
  
    <script src="/ocitutorials/assets/js/tabs.js"></script>
  
    <script src="/ocitutorials/assets/js/sidebar.js"></script>
  


  </body>
</html>
